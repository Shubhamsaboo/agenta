# Check if there are staged changes in the frontend directory
if git diff --cached --name-only | grep -q '^agenta-web/'; then
    cd agenta-web || exit

    # Run Prettier check
    if ! npm run format; then
        echo '‚ö†Ô∏è Formatting issues detected. Running Prettier to fix them...'
        npm run format-fix

        # Stage the fixed files
        git add .

        echo '‚úÖ Formatting issues fixed and changes staged. Proceeding with further checks...'
    else
        echo '‚úÖ Prettier check passed.'
    fi

fi

# Check for changes in backend directory
if git diff --cached --name-only | grep -q '^agenta-backend/'; then
    cd agenta-backend || exit

    # Run black for formatting
    echo 'üîç Running black...'
    if ! black --check .; then
        echo '‚ö†Ô∏è Formatting issues detected. Running black to fix them...'
        black .

        # Stage the fixed files
        git add .

        echo '‚úÖ Formatting issues fixed and changes staged. Proceeding with further checks...'
    else
        echo '‚úÖ black formatting check passed.'
    fi

fi